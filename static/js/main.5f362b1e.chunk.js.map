{"version":3,"sources":["components/Chart.js","components/Tooltip.js","components/NetworkGraph.js","components/Scale.js","components/ContributionList.js","App.js","serviceWorker.js","index.js"],"names":["d3","require","Chart","props","svgRef","React","useRef","contentRef","useEffect","svg","select","current","contentElement","zoomtool","call","zoom","extent","width","height","scaleExtent","on","attr","event","transform","viewbox","id","chartId","viewBox","ref","children","Tooltip","className","title","body","NetworkGraph","graph","data","centerX","centerY","ring1PhaseShift","Math","PI","nodes","length","ring2PhaseShift","chartRef","tooltipRef","useState","tooltipTitle","setTooltipTitle","tooltipBody","setTooltipBody","getRadiusX","d","votesCount","sqrt","getRadiusY","getFontSize","max","name","getColor","colors","getNodeX","selected","radius","cos","getNodeY","sin","nodeWraps","selectAll","enter","append","classed","root","allNodes","style","html","selColor","selSubFontSize","min","radiusX","radiusY","e","transition","duration","ring1Nodes","filter","remove","raise","selKeyWords","keywords","parentRadiusX","getNode2X","parentRadiusY","getNode2Y","f","onClick","votesCountOk","clientX","clientY","Scale","circlesCfg","i","r","filled","quantiles","score","circles","map","cx","cy","key","stroke","color","fill","ContributionItem","bodyRef","expanded","setExpanded","command","setCommand","showExpand","setShowExpand","setTimeout","scrollHeight","clientHeight","dynStyle","borderColor","contrib","contribution_versions_title","contribution_versions_bodyText","contributions_votesCountOk","contributions_votesCount","ContributionList","contributionListRef","contributionSummary","undefined","contributions","c","topic_id","colorPalette","topic","keyword","scrollTo","createBrowserHistory","basename","process","App","loaded","setLoaded","filterTitle","setFilterTitle","selectedContributions","setSelectedContributions","selectionId","setSelectionId","selectTopic","topic_title","keyword_id","console","log","filePath","axios","get","then","result","catch","error","getTopicContributions","graphData","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.5f362b1e.chunk.js","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\n\nvar d3 = require(\"d3\")\n\nconst Chart = (props) => {\n\n  const svgRef = React.useRef('')\n  const contentRef = React.useRef('')\n\n  React.useEffect(\n    () => {\n\n      const svg = d3.select(svgRef.current)\n      const contentElement = d3.select(contentRef.current)\n\n      // Zoom & pan\n      if (props.zoomtool) {\n        svg.call(d3.zoom()\n          .extent([[0, 0], [props.width, props.height]])\n          .scaleExtent([1, 2])\n          .on(\"zoom\", zoomed));\n      }\n\n      function zoomed() {\n        contentElement.attr(\"transform\", d3.event.transform);\n      }\n    })\n\n  const viewbox = \"0 0 \" + props.width + \" \" + props.height\n\n  return <div>\n    <svg id={props.chartId} viewBox={viewbox} ref={svgRef}>\n      <g ref={contentRef}>\n        {props.children}\n      </g>\n    </svg>\n  </div>\n  // width={props.width} height={props.height} \n}\n\nChart.propTypes = {\n  width: PropTypes.number,\n  height: PropTypes.number,\n  chartId: PropTypes.string\n}\n\nexport default Chart","import React from 'react'\n\nconst Tooltip = (props) => (\n  <foreignObject width={200} height={200}>\n    <div className=\"tooltip\"> \n      <div className=\"title\">{props.title}</div>\n      <div className=\"body\">{props.body}</div>\n    </div>\n  </foreignObject>\n)\n\nexport default Tooltip","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Tooltip from './Tooltip'\n\nconst d3 = require(\"d3\")\n\nconst NetworkGraph = (props) => {\n\n  const graph = props.data\n\n  const centerX = props.width / 2, centerY = props.height / 2\n\n  // Ring 1 : main topics\n  const ring1Radius = 250, ring1RadiusDeltaSel = 60;\n  const ring1PhaseShift = 2 * Math.PI / (graph.nodes.length);\n\n  // Ring 2 : keywords\n  const subNodeRadiusX = 40, subNodeRadiusY = 20;\n  const ring2PhaseShift = 2 * Math.PI / 8; // 8 keywords by design\n\n  const defaultRadiusX = 60, defaultRadiusY = 50;\n  // Default font size [px]\n  const defaultFontSize = 14;\n\n  // Transition duration\n  const transitionDurationMs = 2000\n\n  // References to DOM elements\n  const chartRef = React.useRef('')\n  const tooltipRef = React.useRef('')\n  const [tooltipTitle, setTooltipTitle] = React.useState('')\n  const [tooltipBody, setTooltipBody] = React.useState('')\n\n  function getRadiusX(d) {\n    if (d.id === 'root') return 120;\n    return (d.votesCount) ? (2.6e-1 * Math.sqrt(d.votesCount)) : defaultRadiusX;\n  }\n\n  function getRadiusY(d) {\n    if (d.id === 'root') return 100;\n    return (d.votesCount) ? (2.2e-1 * Math.sqrt(d.votesCount)) : defaultRadiusY;\n  }\n\n  function getFontSize(d) {\n    if (d.id === 'root') return 36;\n    return ((d.votesCount) ? (3.5e-1 * Math.sqrt(d.votesCount / Math.max(30, d.name.length))) : defaultFontSize);\n  }\n\n  function getColor(d) {\n    if (d.id === 'root')\n      return '#fafafe'\n    return props.colors[d.id % props.colors.length]\n  }\n\n  function getNodeX(d, selected = false) {\n    if (d.id === 'root') return centerX\n    const radius = ring1Radius + ((selected === true) ? ring1RadiusDeltaSel : 0)\n    return centerX + radius * Math.cos(ring1PhaseShift * d.id)\n  }\n\n  function getNodeY(d, selected = false) {\n    if (d.id === 'root') return centerY\n    const radius = ring1Radius + ((selected === true) ? ring1RadiusDeltaSel : 0)\n    return centerY + radius * Math.sin(ring1PhaseShift * d.id)\n  }\n\n  function getNode2X(d, parentRadiusX) {\n    // Position nodes as function of id (increasing from 0 to 8)\n    // Add alternate offset ring1RadiusDelta\n    return (parentRadiusX + subNodeRadiusX) * Math.cos(ring2PhaseShift * d.id)\n  }\n\n  function getNode2Y(d, parentRadiusY) {\n    return (parentRadiusY + subNodeRadiusY) * Math.sin(ring2PhaseShift * d.id)\n  }\n\n\n  // useEffect allow for d3 to interact with the DOM outside of React\n  React.useEffect(\n    () => {\n\n      // Hide tooltip\n      d3.select(tooltipRef.current)\n        .attr(\"opacity\", 0)\n\n      // Node Wraps\n      const nodeWraps = d3.select(chartRef.current)\n        .selectAll(\".ring1\")\n        .data(graph.nodes)\n        .enter()\n        .append('g')\n\n      // Ring 1 Links\n      nodeWraps.append(\"line\")\n        .classed(\"link\", true)\n        .attr(\"x1\", centerX)\n        .attr(\"y1\", centerY)\n        .attr(\"x2\", getNodeX)\n        .attr(\"y2\", getNodeY)\n\n      // Ring 1 Nodes\n      nodeWraps.append('g')\n        .classed('ring1', true)\n        .attr(\"transform\", d => \"translate(\" + getNodeX(d) + \",\" + getNodeY(d) + \")\")\n        .append('g')\n        .classed('node', true)\n\n      // Root\n      nodeWraps.selectAll('.root')\n        .data(graph.root)\n        .enter()\n        .append('g')\n        .classed('node', true)\n        .classed('root', true)\n        .attr(\"transform\", \"translate(\" + centerX + \",\" + centerY + \")\")\n\n      // Reselect root + ring 1 nodes\n      const allNodes = nodeWraps.selectAll('.node')\n\n      // Shape of node\n      allNodes.append(\"ellipse\")\n        .classed('node-shape', true)\n        .attr(\"rx\", getRadiusX)\n        .attr(\"ry\", getRadiusY)\n        .style(\"fill\", getColor);\n\n      // Label of node\n      allNodes.append(\"foreignObject\")\n        .attr(\"width\", d => 2 * getRadiusX(d))\n        .attr(\"height\", d => 2 * getRadiusY(d))\n        .attr(\"x\", d => - getRadiusX(d))\n        .attr(\"y\", d => - getRadiusY(d))\n        .append(\"xhtml:div\")\n        .classed(\"label\", true)\n        .style(\"line-height\", d => (2 * getRadiusY(d)) + 'px')\n        .style(\"font-size\", d => getFontSize(d) + \"px\")\n        .html(d => '<span>' + d.name + '</span>');\n\n      //= Actions =//\n\n      allNodes.on(\"click\", d => {\n\n        const selColor = getColor(d)\n        const selSubFontSize = Math.min(Math.max(0.8 * getFontSize(d), 9), 12)\n        const radiusX = getRadiusX(d), radiusY = getRadiusY(d)\n\n        // Set selection on all nodes\n        allNodes.selectAll('ellipse')\n          .classed('selected', e => e.id === d.id)\n\n        allNodes.selectAll('.ring2 ellipse')\n          .classed('selected', false)\n\n        d3.select(chartRef.current)\n          .transition()\n          .attr(\"transform\", e => \"translate(\" + (centerX - getNodeX(d, true)) + \",\" + (centerY - getNodeY(d, true)) + \")\")\n          .duration(transitionDurationMs)\n\n        // Set positions : larger radius for selected node\n        const ring1Nodes = d3.selectAll('.ring1')\n        ring1Nodes.transition()\n          .attr(\"transform\", e => \"translate(\" + getNodeX(e, e.id === d.id) + \",\" + getNodeY(e, e.id === d.id) + \")\")\n          .duration(transitionDurationMs)\n\n        // Remove existing ring of keywords\n        ring1Nodes.filter(e => e.id !== d.id).selectAll('.ring2').remove()\n\n        // TODO FIX Raise selection\n        allNodes.filter(e => e.id === d.id).selectAll('g').raise()\n\n        // Show keyword ring on selection (Note: this is undefined)\n        const selKeyWords = ring1Nodes.filter(e => e.id === d.id).selectAll('.ring2')\n          .data(d => d.keywords)\n          .enter()\n          .append('g')\n          .classed('ring2', true)\n          .attr(\"transform\", e => \"translate(\" + getNode2X(e, radiusX) + \",\" + getNode2Y(e, radiusY) + \")\")\n\n        // Keyword node shape\n        selKeyWords.append(\"ellipse\")\n          .classed('node-shape', true)\n          .attr(\"rx\", subNodeRadiusX)\n          .attr(\"ry\", subNodeRadiusY)\n          .style(\"fill\", selColor)\n          .style(\"opacity\", 0)\n          .transition()\n          .style(\"opacity\", 1)\n          .duration(transitionDurationMs)\n\n        // Keyword node text\n        selKeyWords.append(\"foreignObject\")\n          .attr(\"width\", 2 * subNodeRadiusX)\n          .attr(\"height\", 2 * subNodeRadiusY)\n          .attr(\"x\", -subNodeRadiusX)\n          .attr(\"y\", -subNodeRadiusY)\n          .append(\"xhtml:div\")\n          .classed(\"label\", true)\n          .style(\"line-height\", (2 * subNodeRadiusY) + 'px')\n          .style(\"font-size\", selSubFontSize + \"px\")\n          .html(e => '<span>' + e.name + '</span>')\n\n        selKeyWords.on('click', e => {\n          // Set selection on all ring2 keyword nodes\n          selKeyWords.selectAll('ellipse')\n            .classed('selected', f => f.id === e.id)\n\n          // Signal selection to parent\n          props.onClick(d.id, d.name, e.id, e.name)\n        })\n\n        // Signal selection to parent\n        props.onClick(d.id, d.name, null)\n      })\n        .on(\"mouseover\", function (d) {\n          setTooltipTitle(d.name)\n          setTooltipBody(d.votesCount + \" votes dont \" + d.votesCountOk + \" favorables\")\n\n          d3.select(tooltipRef.current)\n            .attr(\"transform\", \"translate(\" + (d3.event.clientX+10)+ \",\" + (d3.event.clientY+10) + \")\")\n            .transition()\n            .attr(\"opacity\", 1)\n            .duration(200)\n        })\n        .on(\"mouseout\", function (d) {\n\n          d3.select(tooltipRef.current)\n            .transition()\n            .attr(\"opacity\", 0)\n            .duration(200)\n        })\n    })\n\n  return <g className=\"network-graph\">\n    <g ref={chartRef}>\n    </g>\n    <g ref={tooltipRef}>\n      <Tooltip title={tooltipTitle} body={tooltipBody}></Tooltip>\n    </g>\n  </g>\n}\n\nNetworkGraph.propTypes = {\n  width: PropTypes.number,\n  height: PropTypes.number,\n  data: PropTypes.object\n}\n\nexport default NetworkGraph","import React from 'react'\nimport PropTypes from 'prop-types'\n\nconst Scale = (props) => {\n\n  const num_circles = 4\n  const paddingH = 5, paddingV = 5;\n  const width = 8 * props.radius + 5 * paddingH\n  const height = 2 * props.radius + 2 * paddingV\n  \n  const circlesCfg = []\n  for(var i = 0; i < num_circles; i++){\n    var r = props.radius / Math.sqrt(num_circles - i)\n    circlesCfg[i] = {\n        radius: r, \n        centerX: (1 + i) * paddingH + (1 + 2 * i) * props.radius, \n        centerY: (height / 2), id: props.id + '_' + i, // height - paddingV - r, \n        filled: props.quantiles[i] < props.score\n    }\n  }\n  \n  const circles = circlesCfg.map(d => <circle r={d.radius} cx={d.centerX} cy={d.centerY} key={d.id}\n    stroke={props.color} fill={(d.filled)?props.color:\"transparent\"}>\n  </circle>)\n\n  return <svg width={width} height={height}>\n    <g>\n      {circles}\n    </g>\n  </svg>\n}\n\nScale.propTypes = {\n  radius: PropTypes.number,\n  color: PropTypes.string\n}\n\nexport default Scale","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Scale from './Scale'\n\n\n// Contribution item\nconst ContributionItem = (props) => {\n\n  const bodyRef = React.useRef()\n  const [expanded, setExpanded] = React.useState('')\n  const [command, setCommand] = React.useState('+')\n  const [showExpand, setShowExpand] = React.useState(false)\n\n  function toggleExpand() {\n    if (!expanded) {\n      setExpanded('expanded')\n      setCommand('-')\n    }\n    else {\n      setExpanded('')\n      setCommand('+')\n    }\n  }\n\n  React.useEffect(() => {\n    setTimeout(() => {\n      const body = bodyRef.current\n      const heightDiff = body.scrollHeight - body.clientHeight\n      //console.log(\"contrib : \" + heightDiff + ', ' + body.scrollHeight + ', ' + body.clientHeight)\n      if (heightDiff < 15) {\n        setExpanded('expanded')\n      }\n      else {\n        setShowExpand(true)\n      }\n    }, 10)\n  }, [bodyRef])\n\n  const dynStyle = {\n    color: props.color,\n    borderColor: props.color\n  }\n\n  return <li key={props.id} className=\"contribution-list-item\">\n    <h1 className=\"contribution-title\">{props.contrib.contribution_versions_title}</h1>\n    <div className=\"contribution-body\" >\n      <div className={\"text \" + expanded} ref={bodyRef}>{props.contrib.contribution_versions_bodyText}</div>\n      {expanded === '' && <div className='mask'></div>}\n    </div>\n    <div className=\"bottom\">\n      <div className=\"buttons\">{showExpand && <button onClick={toggleExpand}>{command}</button>}</div>\n      <div className=\"scale\"><Scale radius={8} color={props.color} score={props.contrib.contributions_votesCountOk} quantiles={props.quantiles}></Scale></div>\n      <div className=\"vote-count\"  style={dynStyle}>{props.contrib.contributions_votesCount} votes dont {props.contrib.contributions_votesCountOk} favorables</div>\n    </div>\n  </li>\n}\n\n// Contribution list\nconst ContributionList = (props) => {\n\n  const contributionListRef = React.useRef(null)\n\n  function getTopicScaleColor(id) {\n    return props.colorPalette[id % props.colorPalette.length]\n  }\n\n  var contributionSummary = null\n  if (props.contributions !== undefined) {\n    contributionSummary = props.contributions\n      .map((c, i) => <ContributionItem key={props.id + '_' + i} id={props.id + '_' + i} contrib={c} \n        color={getTopicScaleColor(c.topic_id)} quantiles={props.quantiles}></ContributionItem>)\n  }\n\n  var title = ''\n  if (props.title) {\n    title += props.title.topic\n    if (!!props.title.keyword) {\n      title += ' > ' + props.title.keyword\n    }\n  }\n\n  React.useEffect(() => {\n    contributionListRef.current.scrollTo(0, 0)\n  }, [contributionSummary])\n\n  return <div ref={contributionListRef} className=\"contribution-list\">\n    {props.title && <h1 className='contribution-list-title'>{title}</h1>}\n    <ul className=\"contribution-list-list\">\n      {contributionSummary}\n    </ul>\n  </div>\n}\n\nContributionList.propTypes = {\n  title: PropTypes.object,\n  color: PropTypes.string,\n  contributions: PropTypes.array\n}\n\nexport default ContributionList","import './App.css';\nimport graphData from './data/le-vrai-debat.json'\nimport Chart from './components/Chart'\nimport NetworkGraph from './components/NetworkGraph'\nimport ContributionList from './components/ContributionList'\n\nimport React from 'react';\nimport { createBrowserHistory } from 'history';\nimport axios from 'axios';\n\n\nfunction App() {\n\n  // Topic color palettes for node shape\n  // From https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/\n  // Column 3\n  const colorPalette = ['#E6B0AA', '#D7BDE2', '#A9CCE3', \n                        '#A3E4D7', '#FAD7A0', '#F5B7B1', \n                        '#D2B4DE', '#A9DFBF', '#F9E79F']\n  // Topic color palettes for texts and scale\n  // From https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/\n  // Column 5 or 6\n  const colorPaletteScale = ['#CD6155', '#9B59B6', '#2980B9', \n                            '#1ABC9C', '#F39C12', '#E74C3C',\n                            '#8E44AD',  '#27AE60', '#F1C40F']\n\n  // Contribution \"quantiles\" = repartition by importance\n  const quantiles = [500, 1000, 2500, 4000]\n\n  const [loaded, setLoaded] = React.useState(false)\n  const [filterTitle, setFilterTitle] = React.useState({topic: null, keyword: null})\n  const [selectedContributions, setSelectedContributions] = React.useState([])\n  const [selectionId, setSelectionId] = React.useState(\"root_unknown\")\n\n  // Get the contributions related to the topic (& keyword) or the whole (id=\"root\")\n  function getTopicContributions(topic_id, keyword_id) {\n    if (keyword_id === undefined || keyword_id === null) {\n      const filePath = './data/topic_' + topic_id + '_main_contributions.json'\n      axios.get(filePath)\n        .then((result) => {\n          setSelectedContributions(result.data)\n        })\n        .catch((error) => {\n          console.log(error);\n        })\n    }\n    else {\n      const filePath = './data/topic_' + topic_id + '_keyword_' + keyword_id + '_main_contributions.json'\n      axios.get(filePath)\n        .then((result) => {\n          setSelectedContributions(result.data)\n        })\n        .catch((error) => {\n          console.log(error);\n        })\n    }\n  }\n\n  // Update the view when a topic (and a keyword) are selected\n  function selectTopic(topic_id, topic_title, keyword_id, keyword) {\n    console.log(\"Topic clicked: topic='\" + topic_title + \"', keyword=\" + keyword)\n\n    setFilterTitle({topic: topic_title, keyword: keyword})\n    getTopicContributions(topic_id, keyword_id)\n    setSelectionId('' + topic_id + '_' + ((keyword_id !== null)?keyword_id:'unknown'))\n  }\n\n  // Select root by default\n  React.useEffect(() => {\n    if(!loaded){\n      selectTopic('root', \"Le Vrai Débat\", null)\n      setLoaded(true)\n    }\n  }, [loaded])\n\n  // Viewport sizing dimensions but not to set hard dimensions on the graph\n  const width = 700, height = 700;\n\n  return (\n    <div className=\"App\">\n      <div className=\"app-wrap\">\n        <div className=\"chart-wrap\">\n          <Chart chartId='first' width={width} height={height} zoomtool={false}>\n            <NetworkGraph width={width} height={height} data={graphData}\n              onClick={selectTopic} colors={colorPalette}></NetworkGraph>\n          </Chart>\n        </div>\n        <div className=\"contributions-wrap\">\n          <ContributionList title={filterTitle} contributions={selectedContributions} id={selectionId} \n            colorPalette={colorPaletteScale} quantiles={quantiles}></ContributionList>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Locate the final installation within a subdirectory\nexport const history = createBrowserHistory({\n  basename: process.env.PUBLIC_URL\n}); \n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}