{"version":3,"sources":["components/Chart.js","components/NetworkGraph.js","components/Scale.js","components/ContributionList.js","App.js","serviceWorker.js","index.js"],"names":["d3","require","Chart","props","svgRef","React","useRef","contentRef","useEffect","svg","select","current","contentElement","zoomtool","call","zoom","extent","width","height","scaleExtent","on","attr","event","transform","viewbox","id","chartId","viewBox","ref","children","NetworkGraph","graph","data","centerX","centerY","ring1PhaseShift","Math","PI","nodes","length","ring2PhaseShift","chartRef","getRadiusX","d","votesCount","sqrt","getRadiusY","getFontSize","max","name","getColor","colors","getNodeX","selected","radius","cos","getNodeY","sin","nodeWraps","selectAll","enter","append","classed","root","allNodes","style","html","selColor","selSubFontSize","min","radiusX","radiusY","e","transition","duration","ring1Nodes","filter","remove","raise","selKeyWords","keywords","parentRadiusX","getNode2X","parentRadiusY","getNode2Y","f","onClick","className","Scale","circlesCfg","i","r","filled","quantiles","score","circles","map","cx","cy","key","stroke","color","fill","number_format","n","Intl","NumberFormat","format","ContributionItem","bodyRef","useState","expanded","setExpanded","command","setCommand","showExpand","setShowExpand","setTimeout","body","scrollHeight","clientHeight","dynStyle","borderColor","contrib","contribution_versions_title","contribution_versions_bodyText","contributions_votesCountOk","contributions_votesCount","ContributionList","contributionListRef","getTopicScaleColor","colorPalette","contributionSummary","undefined","contributions","c","topic_id","title","subtitle","topic","keyword","votesCountOk","scrollTo","createBrowserHistory","basename","process","App","loaded","setLoaded","filterTitle","setFilterTitle","selectedContributions","setSelectedContributions","selectionId","setSelectionId","selectTopic","topic_title","keyword_id","console","log","graphData","filePath","axios","get","then","result","catch","error","getTopicContributions","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","message"],"mappings":"u4GAGIA,EAAKC,EAAQ,IA4CFC,EA1CD,SAACC,GAEb,IAAMC,EAASC,IAAMC,OAAO,IACtBC,EAAaF,IAAMC,OAAO,IAEhCD,IAAMG,WACJ,WAEE,IAAMC,EAAMT,EAAGU,OAAON,EAAOO,SACvBC,EAAiBZ,EAAGU,OAAOH,EAAWI,SAGxCR,EAAMU,UACRJ,EAAIK,KAAKd,EAAGe,OACTC,OAAO,CAAC,CAAC,EAAG,GAAI,CAACb,EAAMc,MAAOd,EAAMe,UACpCC,YAAY,CAAC,EAAG,IAChBC,GAAG,QAGR,WACER,EAAeS,KAAK,YAAarB,EAAGsB,MAAMC,kBAIhD,IAAMC,EAAU,OAASrB,EAAMc,MAAQ,IAAMd,EAAMe,OAEnD,OAAO,6BACL,yBAAKO,GAAItB,EAAMuB,QAASC,QAASH,EAASI,IAAKxB,GAC7C,uBAAGwB,IAAKrB,GACLJ,EAAM0B,aC/BT7B,EAAKC,EAAQ,IA2OJ6B,EAzOM,SAAC3B,GAEpB,IAAM4B,EAAQ5B,EAAM6B,KAEdC,EAAU9B,EAAMc,MAAQ,EAAGiB,EAAU/B,EAAMe,OAAS,EAIpDiB,EAAkB,EAAIC,KAAKC,GAAMN,EAAMO,MAAMC,OAI7CC,EAAkB,EAAIJ,KAAKC,GAAK,EAUhCI,EAAWpC,IAAMC,OAAO,IAE9B,SAASoC,EAAWC,GAClB,MAAa,SAATA,EAAElB,GAAsB,IACpBkB,EAAEC,WAAe,IAASR,KAAKS,KAAKF,EAAEC,YAZzB,GAevB,SAASE,EAAWH,GAClB,MAAa,SAATA,EAAElB,GAAsB,IACpBkB,EAAEC,WAAe,IAASR,KAAKS,KAAKF,EAAEC,YAjBJ,GAoB5C,SAASG,EAAYJ,GACnB,MAAa,SAATA,EAAElB,GAAsB,GACnBkB,EAAEC,WAAe,IAASR,KAAKS,KAAKF,EAAEC,WAAaR,KAAKY,IAAI,GAAIL,EAAEM,KAAKV,SApB1D,GAuBxB,SAASW,EAASP,GAChB,MAAa,SAATA,EAAElB,GACG,UACFtB,EAAMgD,OAAOR,EAAElB,GAAKtB,EAAMgD,OAAOZ,QAG1C,SAASa,EAAST,GAAsB,IAAnBU,EAAkB,wDACrC,GAAa,SAATV,EAAElB,GAAe,OAAOQ,EAC5B,IAAMqB,EAxCY,MAwC0B,IAAbD,EAxCc,IAwC6B,GAC1E,OAAOpB,EAAUqB,EAASlB,KAAKmB,IAAIpB,EAAkBQ,EAAElB,IAGzD,SAAS+B,EAASb,GAAsB,IAAnBU,EAAkB,wDACrC,GAAa,SAATV,EAAElB,GAAe,OAAOS,EAC5B,IAAMoB,EA9CY,MA8C0B,IAAbD,EA9Cc,IA8C6B,GAC1E,OAAOnB,EAAUoB,EAASlB,KAAKqB,IAAItB,EAAkBQ,EAAElB,IAuKzD,OAxJApB,IAAMG,WACJ,WAGE,IAAMkD,EAAY1D,EAAGU,OAAO+B,EAAS9B,SAClCgD,UAAU,UACV3B,KAAKD,EAAMO,OACXsB,QACAC,OAAO,KAGVH,EAAUG,OAAO,QACdC,QAAQ,QAAQ,GAChBzC,KAAK,KAAMY,GACXZ,KAAK,KAAMa,GACXb,KAAK,KAAM+B,GACX/B,KAAK,KAAMmC,GAGdE,EAAUG,OAAO,KACdC,QAAQ,SAAS,GACjBzC,KAAK,aAAa,SAAAsB,GAAC,MAAI,aAAeS,EAAST,GAAK,IAAMa,EAASb,GAAK,OACxEkB,OAAO,KACPC,QAAQ,QAAQ,GAGnBJ,EAAUC,UAAU,SACjB3B,KAAKD,EAAMgC,MACXH,QACAC,OAAO,KACPC,QAAQ,QAAQ,GAChBA,QAAQ,QAAQ,GAChBA,QAAQ,YAAY,GACpBzC,KAAK,YAAa,aAAeY,EAAU,IAAMC,EAAU,KAG9D,IAAM8B,EAAWN,EAAUC,UAAU,SAGrCK,EAASH,OAAO,WACbC,QAAQ,cAAc,GACtBzC,KAAK,KAAMqB,GACXrB,KAAK,KAAMyB,GACXmB,MAAM,OAAQf,GAGjBc,EAASH,OAAO,iBACbxC,KAAK,SAAS,SAAAsB,GAAC,OAAI,EAAID,EAAWC,MAClCtB,KAAK,UAAU,SAAAsB,GAAC,OAAI,EAAIG,EAAWH,MACnCtB,KAAK,KAAK,SAAAsB,GAAC,OAAMD,EAAWC,MAC5BtB,KAAK,KAAK,SAAAsB,GAAC,OAAMG,EAAWH,MAC5BkB,OAAO,aACPC,QAAQ,SAAS,GACjBG,MAAM,eAAe,SAAAtB,GAAC,OAAK,EAAIG,EAAWH,GAAM,QAChDsB,MAAM,aAAa,SAAAtB,GAAC,OAAII,EAAYJ,GAAK,QACzCuB,MAAK,SAAAvB,GAAC,MAAI,SAAWA,EAAEM,KAAO,aAIjCe,EAAS5C,GAAG,SAAS,SAAAuB,GAEnB,IAAMwB,EAAWjB,EAASP,GACpByB,EAAiBhC,KAAKiC,IAAIjC,KAAKY,IAAI,GAAMD,EAAYJ,GAAI,GAAI,IAC7D2B,EAAU5B,EAAWC,GAAI4B,EAAUzB,EAAWH,GAGpDqB,EAASF,QAAQ,YAAY,SAAAU,GAAC,OAAIA,EAAE/C,KAAOkB,EAAElB,MAE7CzB,EAAGU,OAAO+B,EAAS9B,SAChB8D,aACApD,KAAK,aAAa,SAAAmD,GAAC,MAAI,cAAgBvC,EAAUmB,EAAST,GAAG,IAAS,KAAOT,EAAUsB,EAASb,GAAG,IAAS,OAC5G+B,SAzHoB,KA4HvB,IAAMC,EAAa3E,EAAG2D,UAAU,UAChCgB,EAAWF,aACRpD,KAAK,aAAa,SAAAmD,GAAC,MAAI,aAAepB,EAASoB,EAAGA,EAAE/C,KAAOkB,EAAElB,IAAM,IAAM+B,EAASgB,EAAGA,EAAE/C,KAAOkB,EAAElB,IAAM,OACtGiD,SA/HoB,KAkIvBC,EAAWC,QAAO,SAAAJ,GAAC,OAAIA,EAAE/C,KAAOkB,EAAElB,MAAIkC,UAAU,UAAUkB,SAG1Db,EAASY,QAAO,SAAAJ,GAAC,OAAIA,EAAE/C,KAAOkB,EAAElB,MAAIkC,UAAU,KAAKmB,QAGnD,IAQMC,EARkBJ,EAAWC,QAAO,SAAAJ,GAAC,OAAIA,EAAE/C,KAAOkB,EAAElB,MAAIkC,UAAU,UACrEG,QAAQ,YAAY,GACpB9B,MAAK,SAAAW,GAAC,OAAIA,EAAEqC,YACZpB,QACAC,OAAO,KACPC,QAAQ,SAAS,GACjBzC,KAAK,aAAa,SAAAmD,GAAC,MAAI,aAxGhC,SAAmB7B,EAAGsC,GAGpB,OAAQA,EAjDa,IAiDqB7C,KAAKmB,IAAIf,EAAkBG,EAAElB,IAqG1ByD,CAAUV,EAAGF,GAAW,IAlGvE,SAAmB3B,EAAGwC,GACpB,OAAQA,EArDkC,IAqDA/C,KAAKqB,IAAIjB,EAAkBG,EAAElB,IAiGI2D,CAAUZ,EAAGD,GAAW,OAE3DV,OAAO,KACxCC,QAAQ,QAAQ,GAGnBiB,EAAYlB,OAAO,WAChBC,QAAQ,cAAc,GACtBzC,KAAK,KA9JS,IA+JdA,KAAK,KA/J8B,IAgKnC4C,MAAM,OAAQE,GACdF,MAAM,UAAW,GACjBQ,aACAR,MAAM,UAAW,GACjBS,SA5JoB,KA+JvBK,EAAYlB,OAAO,iBAChBxC,KAAK,QAAS,IACdA,KAAK,SAAU,IACfA,KAAK,KA1KS,IA2KdA,KAAK,KA3K8B,IA4KnCwC,OAAO,aACPC,QAAQ,SAAS,GACjBG,MAAM,cAAgB,QACtBA,MAAM,YAAaG,EAAiB,MACpCF,MAAK,SAAAM,GAAC,MAAI,SAAWA,EAAEvB,KAAO,aAEjC8B,EAAY3D,GAAG,SAAS,SAAAoD,GAEtBO,EAAYjB,QAAQ,YAAY,SAAAuB,GAAC,OAAIA,EAAE5D,KAAO+C,EAAE/C,MAGhDtB,EAAMmF,QAAQ3C,EAAElB,GAAIkB,EAAEM,KAAMuB,EAAE/C,GAAI+C,EAAEvB,SAErC7B,GAAG,aAAa,SAAAoD,GACfxE,EAAGU,OAAO+B,EAAS9B,SAASgD,UAAU,kBACnCG,QAAQ,SAAS,SAAAuB,GAAC,OAAIA,EAAE5D,KAAO+C,EAAE/C,SAErCL,GAAG,YAAY,SAAAoD,GACdxE,EAAGU,OAAO+B,EAAS9B,SAASgD,UAAU,kBACnCG,QAAQ,SAAS,MAOtB3D,EAAMmF,QAAQ3C,EAAElB,GAAIkB,EAAEM,KAAM,SAE3B7B,GAAG,aAAa,SAAAuB,GACf3C,EAAGU,OAAO+B,EAAS9B,SAASgD,UAAU,kBACnCG,QAAQ,SAAS,SAAAU,GAAC,OAAIA,EAAE/C,KAAOkB,EAAElB,SAErCL,GAAG,YAAY,SAAAuB,GACd3C,EAAGU,OAAO+B,EAAS9B,SAASgD,UAAU,kBACnCG,QAAQ,SAAS,SAIrB,uBAAGyB,UAAU,iBAClB,uBAAG3D,IAAKa,MC9LG+C,EAlCD,SAACrF,GAQb,IANA,IAEMc,EAAQ,EAAId,EAAMmD,OAAS,GAC3BpC,EAAS,EAAIf,EAAMmD,OAAS,GAE5BmC,EAAa,GACXC,EAAI,EAAGA,EANK,EAMYA,IAAI,CAClC,IAAIC,EAAIxF,EAAMmD,OAASlB,KAAKS,KAPV,EAO6B6C,GAC/CD,EAAWC,GAAK,CACZpC,OAAQqC,EACR1D,QATW,GASD,EAAIyD,IAAiB,EAAI,EAAIA,GAAKvF,EAAMmD,OAClDpB,QAAUhB,EAAS,EAAIO,GAAItB,EAAMsB,GAAK,IAAMiE,EAC5CE,OAAQzF,EAAM0F,UAAUH,GAAKvF,EAAM2F,OAIzC,IAAMC,EAAUN,EAAWO,KAAI,SAAArD,GAAC,OAAI,4BAAQgD,EAAGhD,EAAEW,OAAQ2C,GAAItD,EAAEV,QAASiE,GAAIvD,EAAET,QAASiE,IAAKxD,EAAElB,GAC5F2E,OAAQjG,EAAMkG,MAAOC,KAAO3D,EAAEiD,OAAQzF,EAAMkG,MAAM,mBAGpD,OAAO,yBAAKpF,MAAOA,EAAOC,OAAQA,GAChC,2BACG6E,KCvBP,SAASQ,EAAcC,GACrB,OAAOC,KAAKC,eAAeC,OAAOH,GAKpC,IAAMI,EAAmB,SAACzG,GAExB,IAAM0G,EAAUxG,IAAMC,SAFY,EAGFD,IAAMyG,SAAS,IAHb,mBAG3BC,EAH2B,KAGjBC,EAHiB,OAIJ3G,IAAMyG,SAAS,KAJX,mBAI3BG,EAJ2B,KAIlBC,EAJkB,OAKE7G,IAAMyG,UAAS,GALjB,mBAK3BK,EAL2B,KAKfC,EALe,KAkBlC/G,IAAMG,WAAU,WACd6G,YAAW,WACT,IAAMC,EAAOT,EAAQlG,QACF2G,EAAKC,aAAeD,EAAKE,aAE3B,GACfR,EAAY,YAGZI,GAAc,KAEf,OACF,CAACP,IAEJ,IAAMY,EAAW,CACfpB,MAAOlG,EAAMkG,MACbqB,YAAavH,EAAMkG,OAGrB,OAAO,wBAAIF,IAAKhG,EAAMsB,GAAI8D,UAAU,0BAClC,4BAAKpF,EAAMwH,QAAQC,6BACnB,yBAAKrC,UAAU,qBACb,yBAAKA,UAAW,QAAUwB,EAAUnF,IAAKiF,GAAU1G,EAAMwH,QAAQE,gCACnD,KAAbd,GAAmB,yBAAKxB,UAAU,UAErC,yBAAKA,UAAU,UACb,yBAAKA,UAAU,WAAW4B,GAAc,4BAAQ7B,QArCpD,WACOyB,GAKHC,EAAY,IACZE,EAAW,OALXF,EAAY,YACZE,EAAW,QAkC6DD,IACxE,yBAAK1B,UAAU,aAAatB,MAAOwD,GACjC,yBAAKlC,UAAU,SAAQ,kBAAC,EAAD,CAAOjC,OAAQ,EAAG+C,MAAOlG,EAAMkG,MAAOP,MAAO3F,EAAMwH,QAAQG,2BAA4BjC,UAAW1F,EAAM0F,aAC/H,yBAAKN,UAAU,SAASgB,EAAcpG,EAAMwH,QAAQG,4BAApD,uBAAqGvB,EAAcpG,EAAMwH,QAAQI,0BAAjI,oBA0DOC,EAnDU,SAAC7H,GAExB,IAAM8H,EAAsB5H,IAAMC,OAAO,MAEzC,SAAS4H,EAAmBzG,GAC1B,OAAOtB,EAAMgI,aAAa1G,EAAKtB,EAAMgI,aAAa5F,QAGpD,IAAI6F,EAAsB,UACEC,IAAxBlI,EAAMmI,gBACRF,EAAsBjI,EAAMmI,cACzBtC,KAAI,SAACuC,EAAG7C,GAAJ,OAAU,kBAAC,EAAD,CAAkBS,IAAKhG,EAAMsB,GAAK,IAAMiE,EAAGjE,GAAItB,EAAMsB,GAAK,IAAMiE,EAAGiC,QAASY,EACzFlC,MAAO6B,EAAmBK,EAAEC,UAAW3C,UAAW1F,EAAM0F,gBAG9D,IAAI4C,EAAQ,GAAIC,EAAW,GAAIjB,EAAW,GAC1C,GAAItH,EAAMsI,QACRA,GAAStI,EAAMsI,MAAME,MACfxI,EAAMsI,MAAMG,UAChBH,GAAS,MAAQtI,EAAMsI,MAAMG,SAE/BF,EAAWnC,EAAcpG,EAAMsI,MAAMI,cAAgB,uBAAyBtC,EAAcpG,EAAMsI,MAAMI,cAAgB,oBAE3FR,IAAzBlI,EAAMsI,MAAMD,UAAwB,CACtC,IAAMnC,EAAQ6B,EAAmB/H,EAAMsI,MAAMD,UAC7Cf,EAAW,CACTpB,MAAOA,EACPqB,YAAarB,GASnB,OAJAhG,IAAMG,WAAU,WACdyH,EAAoBtH,QAAQmI,SAAS,EAAG,KACvC,CAACV,IAEG,yBAAKxG,IAAKqG,EAAqB1C,UAAU,qBAC9C,4BAAKkD,GACL,wBAAIxE,MAAOwD,GAAWiB,GACtB,wBAAInD,UAAU,0BACX6C,K,wBCAgBW,YAAqB,CAC1CC,SAAUC,mBADL,IAIQC,EAjGf,WAKE,IALa,EAkBe7I,IAAMyG,UAAS,GAlB9B,mBAkBNqC,EAlBM,KAkBEC,EAlBF,OAmByB/I,IAAMyG,SAAS,CAAC6B,MAAO,KAAMC,QAAS,OAnB/D,mBAmBNS,EAnBM,KAmBOC,EAnBP,OAoB6CjJ,IAAMyG,SAAS,IApB5D,mBAoBNyC,EApBM,KAoBiBC,EApBjB,OAqByBnJ,IAAMyG,SAAS,gBArBxC,mBAqBN2C,EArBM,KAqBOC,EArBP,KAgDb,SAASC,EAAYnB,EAAUoB,EAAaC,EAAYjB,GAEtD,IAAID,EADJmB,QAAQC,IAAI,yBAA2BH,EAAc,cAAgBhB,GAGnED,EADc,SAAbH,EACOwB,EAAUjG,KAAK,GAGfiG,EAAU1H,MAAMkG,GAG1Bc,EAAe,CAACX,MAAOiB,EAAahB,QAASA,EAAShG,WAAY+F,EAAM/F,WAAYiG,aAAcF,EAAME,aAAcL,SAAUA,IAlClI,SAA+BA,EAAUqB,GACvC,QAAmBxB,IAAfwB,GAA2C,OAAfA,EAAqB,CACnD,IAAMI,EAAW,gBAAkBzB,EAAW,2BAC9C0B,IAAMC,IAAIF,GACPG,MAAK,SAACC,GACLb,EAAyBa,EAAOrI,SAEjCsI,OAAM,SAACC,GACNT,QAAQC,IAAIQ,UAGb,CACH,IAAMN,EAAW,gBAAkBzB,EAAW,YAAcqB,EAAa,2BACzEK,IAAMC,IAAIF,GACPG,MAAK,SAACC,GACLb,EAAyBa,EAAOrI,SAEjCsI,OAAM,SAACC,GACNT,QAAQC,IAAIQ,OAiBlBC,CAAsBhC,EAAUqB,GAChCH,EAAoBlB,EAAW,KAAuB,OAAfqB,EAAqBA,EAAW,YAczE,OAVAxJ,IAAMG,WAAU,WACV2I,IACFQ,EAAY,OAAQ,mBAAiB,MACrCP,GAAU,MAEX,CAACD,IAMF,yBAAK5D,UAAU,OACb,yBAAKA,UAAU,YACb,yBAAKA,UAAU,cACb,kBAAC,EAAD,CAAO7D,QAAQ,QAAQT,MANjB,IAM+BC,OANjB,IAMiCL,UAAU,GAC7D,kBAAC,EAAD,CAAcI,MAPV,IAOwBC,OAPV,IAO0Bc,KAAMgI,EAChD1E,QAASqE,EAAaxG,OA3Eb,CAAC,UAAW,UAAW,UACtB,UAAW,UAAW,UACtB,UAAW,UAAW,eA4EtC,yBAAKoC,UAAU,sBACb,kBAAC,EAAD,CAAkBkD,MAAOY,EAAaf,cAAeiB,EAAuB9H,GAAIgI,EAC9EtB,aA1EgB,CAAC,UAAW,UAAW,UACvB,UAAW,UAAW,UACtB,UAAY,UAAW,WAwENtC,UArEzB,CAAC,IAAK,IAAM,KAAM,WCflB4E,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,SDyHpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBjB,MAAK,SAAAkB,GACJA,EAAaC,gBAEdjB,OAAM,SAAAC,GACLT,QAAQS,MAAMA,EAAMiB,c","file":"static/js/main.92468810.chunk.js","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\n\nvar d3 = require(\"d3\")\n\nconst Chart = (props) => {\n\n  const svgRef = React.useRef('')\n  const contentRef = React.useRef('')\n\n  React.useEffect(\n    () => {\n\n      const svg = d3.select(svgRef.current)\n      const contentElement = d3.select(contentRef.current)\n\n      // Zoom & pan\n      if (props.zoomtool) {\n        svg.call(d3.zoom()\n          .extent([[0, 0], [props.width, props.height]])\n          .scaleExtent([1, 2])\n          .on(\"zoom\", zoomed));\n      }\n\n      function zoomed() {\n        contentElement.attr(\"transform\", d3.event.transform);\n      }\n    })\n\n  const viewbox = \"0 0 \" + props.width + \" \" + props.height\n\n  return <div>\n    <svg id={props.chartId} viewBox={viewbox} ref={svgRef}>\n      <g ref={contentRef}>\n        {props.children}\n      </g>\n    </svg>\n  </div>\n  // width={props.width} height={props.height} \n}\n\nChart.propTypes = {\n  width: PropTypes.number,\n  height: PropTypes.number,\n  chartId: PropTypes.string\n}\n\nexport default Chart","import React from 'react'\nimport PropTypes from 'prop-types'\n\nconst d3 = require(\"d3\")\n\nconst NetworkGraph = (props) => {\n\n  const graph = props.data\n\n  const centerX = props.width / 2, centerY = props.height / 2\n\n  // Ring 1 : main topics\n  const ring1Radius = 250, ring1RadiusDeltaSel = 130;\n  const ring1PhaseShift = 2 * Math.PI / (graph.nodes.length);\n\n  // Ring 2 : keywords\n  const subNodeRadiusX = 40, subNodeRadiusY = 20;\n  const ring2PhaseShift = 2 * Math.PI / 8; // 8 keywords by design\n\n  const defaultRadiusX = 60, defaultRadiusY = 50;\n  // Default font size [px]\n  const defaultFontSize = 14;\n\n  // Transition duration\n  const transitionDurationMs = 2000\n\n  // References to DOM elements\n  const chartRef = React.useRef('')\n\n  function getRadiusX(d) {\n    if (d.id === 'root') return 120;\n    return (d.votesCount) ? (2.6e-1 * Math.sqrt(d.votesCount)) : defaultRadiusX;\n  }\n\n  function getRadiusY(d) {\n    if (d.id === 'root') return 100;\n    return (d.votesCount) ? (2.2e-1 * Math.sqrt(d.votesCount)) : defaultRadiusY;\n  }\n\n  function getFontSize(d) {\n    if (d.id === 'root') return 36;\n    return ((d.votesCount) ? (3.5e-1 * Math.sqrt(d.votesCount / Math.max(30, d.name.length))) : defaultFontSize);\n  }\n\n  function getColor(d) {\n    if (d.id === 'root')\n      return '#fafafe'\n    return props.colors[d.id % props.colors.length]\n  }\n\n  function getNodeX(d, selected = false) {\n    if (d.id === 'root') return centerX\n    const radius = ring1Radius + ((selected === true) ? ring1RadiusDeltaSel : 0)\n    return centerX + radius * Math.cos(ring1PhaseShift * d.id)\n  }\n\n  function getNodeY(d, selected = false) {\n    if (d.id === 'root') return centerY\n    const radius = ring1Radius + ((selected === true) ? ring1RadiusDeltaSel : 0)\n    return centerY + radius * Math.sin(ring1PhaseShift * d.id)\n  }\n\n  function getNode2X(d, parentRadiusX) {\n    // Position nodes as function of id (increasing from 0 to 8)\n    // Add alternate offset ring1RadiusDelta\n    return (parentRadiusX + subNodeRadiusX) * Math.cos(ring2PhaseShift * d.id)\n  }\n\n  function getNode2Y(d, parentRadiusY) {\n    return (parentRadiusY + subNodeRadiusY) * Math.sin(ring2PhaseShift * d.id)\n  }\n\n\n  // useEffect allow for d3 to interact with the DOM outside of React\n  React.useEffect(\n    () => {\n\n      // Node Wraps\n      const nodeWraps = d3.select(chartRef.current)\n        .selectAll(\".ring1\")\n        .data(graph.nodes)\n        .enter()\n        .append('g')\n\n      // Ring 1 Links\n      nodeWraps.append(\"line\")\n        .classed(\"link\", true)\n        .attr(\"x1\", centerX)\n        .attr(\"y1\", centerY)\n        .attr(\"x2\", getNodeX)\n        .attr(\"y2\", getNodeY)\n\n      // Ring 1 Nodes\n      nodeWraps.append('g')\n        .classed('ring1', true)\n        .attr(\"transform\", d => \"translate(\" + getNodeX(d) + \",\" + getNodeY(d) + \")\")\n        .append('g')\n        .classed('node', true)\n\n      // Root\n      nodeWraps.selectAll('.root')\n        .data(graph.root)\n        .enter()\n        .append('g')\n        .classed('root', true)\n        .classed('node', true)\n        .classed('selected', true) // Selected by default\n        .attr(\"transform\", \"translate(\" + centerX + \",\" + centerY + \")\")\n\n      // Reselect root + ring 1 nodes\n      const allNodes = nodeWraps.selectAll('.node')\n\n      // Shape of node\n      allNodes.append(\"ellipse\")\n        .classed('node-shape', true)\n        .attr(\"rx\", getRadiusX)\n        .attr(\"ry\", getRadiusY)\n        .style(\"fill\", getColor);\n\n      // Label of node\n      allNodes.append(\"foreignObject\")\n        .attr(\"width\", d => 2 * getRadiusX(d))\n        .attr(\"height\", d => 2 * getRadiusY(d))\n        .attr(\"x\", d => - getRadiusX(d))\n        .attr(\"y\", d => - getRadiusY(d))\n        .append(\"xhtml:div\")\n        .classed(\"label\", true)\n        .style(\"line-height\", d => (2 * getRadiusY(d)) + 'px')\n        .style(\"font-size\", d => getFontSize(d) + \"px\")\n        .html(d => '<span>' + d.name + '</span>');\n\n      //= Actions =//\n\n      allNodes.on(\"click\", d => {\n\n        const selColor = getColor(d)\n        const selSubFontSize = Math.min(Math.max(0.8 * getFontSize(d), 9), 12)\n        const radiusX = getRadiusX(d), radiusY = getRadiusY(d)\n\n        // Set selection on all nodes\n        allNodes.classed('selected', e => e.id === d.id)\n\n        d3.select(chartRef.current)\n          .transition()\n          .attr(\"transform\", e => \"translate(\" + (centerX - getNodeX(d, true)) + \",\" + (centerY - getNodeY(d, true)) + \")\")\n          .duration(transitionDurationMs)\n\n        // Set positions : larger radius for selected node\n        const ring1Nodes = d3.selectAll('.ring1')\n        ring1Nodes.transition()\n          .attr(\"transform\", e => \"translate(\" + getNodeX(e, e.id === d.id) + \",\" + getNodeY(e, e.id === d.id) + \")\")\n          .duration(transitionDurationMs)\n\n        // Remove existing ring of keywords\n        ring1Nodes.filter(e => e.id !== d.id).selectAll('.ring2').remove()\n\n        // TODO FIX Raise selection\n        allNodes.filter(e => e.id === d.id).selectAll('g').raise()\n\n        // Show keyword ring on selection (Note: this is undefined)\n        const selKeyWordWraps = ring1Nodes.filter(e => e.id === d.id).selectAll('.ring2')\n          .classed('selected', false)\n          .data(d => d.keywords)\n          .enter()\n          .append('g')\n          .classed('ring2', true)\n          .attr(\"transform\", e => \"translate(\" + getNode2X(e, radiusX) + \",\" + getNode2Y(e, radiusY) + \")\")\n\n        const selKeyWords = selKeyWordWraps.append('g')\n          .classed('node', true)\n\n        // Keyword node shape\n        selKeyWords.append(\"ellipse\")\n          .classed('node-shape', true)\n          .attr(\"rx\", subNodeRadiusX)\n          .attr(\"ry\", subNodeRadiusY)\n          .style(\"fill\", selColor)\n          .style(\"opacity\", 0)\n          .transition()\n          .style(\"opacity\", 1)\n          .duration(transitionDurationMs)\n\n        // Keyword node text\n        selKeyWords.append(\"foreignObject\")\n          .attr(\"width\", 2 * subNodeRadiusX)\n          .attr(\"height\", 2 * subNodeRadiusY)\n          .attr(\"x\", -subNodeRadiusX)\n          .attr(\"y\", -subNodeRadiusY)\n          .append(\"xhtml:div\")\n          .classed(\"label\", true)\n          .style(\"line-height\", (2 * subNodeRadiusY) + 'px')\n          .style(\"font-size\", selSubFontSize + \"px\")\n          .html(e => '<span>' + e.name + '</span>')\n\n        selKeyWords.on('click', e => {\n          // Set selection on all ring2 keyword nodes\n          selKeyWords.classed('selected', f => f.id === e.id)\n\n          // Signal selection to parent\n          props.onClick(d.id, d.name, e.id, e.name)\n        })\n        .on(\"mouseover\", e => {\n          d3.select(chartRef.current).selectAll('.ring2 > .node')\n            .classed('hover', f => f.id === e.id)\n        })\n        .on(\"mouseout\", e => {\n          d3.select(chartRef.current).selectAll('.ring2 > .node')\n            .classed('hover', false)\n        })\n\n        // Complete selection\n        \n\n        // Signal selection to parent\n        props.onClick(d.id, d.name, null)\n      })\n        .on(\"mouseover\", d => {\n          d3.select(chartRef.current).selectAll('.ring1 > .node')\n            .classed('hover', e => e.id === d.id)\n        })\n        .on(\"mouseout\", d => {\n          d3.select(chartRef.current).selectAll('.ring1 > .node')\n            .classed('hover', false)\n        })\n    })\n\n  return <g className=\"network-graph\">\n    <g ref={chartRef}>\n    </g>\n  </g>\n}\n\nNetworkGraph.propTypes = {\n  width: PropTypes.number,\n  height: PropTypes.number,\n  data: PropTypes.object\n}\n\nexport default NetworkGraph","import React from 'react'\nimport PropTypes from 'prop-types'\n\nconst Scale = (props) => {\n\n  const num_circles = 4\n  const paddingH = 5, paddingV = 5;\n  const width = 8 * props.radius + 5 * paddingH\n  const height = 2 * props.radius + 2 * paddingV\n  \n  const circlesCfg = []\n  for(var i = 0; i < num_circles; i++){\n    var r = props.radius / Math.sqrt(num_circles - i)\n    circlesCfg[i] = {\n        radius: r, \n        centerX: (1 + i) * paddingH + (1 + 2 * i) * props.radius, \n        centerY: (height / 2), id: props.id + '_' + i, // height - paddingV - r, \n        filled: props.quantiles[i] < props.score\n    }\n  }\n  \n  const circles = circlesCfg.map(d => <circle r={d.radius} cx={d.centerX} cy={d.centerY} key={d.id}\n    stroke={props.color} fill={(d.filled)?props.color:\"transparent\"}>\n  </circle>)\n\n  return <svg width={width} height={height}>\n    <g>\n      {circles}\n    </g>\n  </svg>\n}\n\nScale.propTypes = {\n  radius: PropTypes.number,\n  color: PropTypes.string\n}\n\nexport default Scale","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Scale from './Scale'\n\nfunction number_format(n) {\n  return Intl.NumberFormat().format(n)\n}\n\n\n// Contribution item\nconst ContributionItem = (props) => {\n\n  const bodyRef = React.useRef()\n  const [expanded, setExpanded] = React.useState('')\n  const [command, setCommand] = React.useState('+')\n  const [showExpand, setShowExpand] = React.useState(false)\n\n  function toggleExpand() {\n    if (!expanded) {\n      setExpanded('expanded')\n      setCommand('-')\n    }\n    else {\n      setExpanded('')\n      setCommand('+')\n    }\n  }\n\n  React.useEffect(() => {\n    setTimeout(() => {\n      const body = bodyRef.current\n      const heightDiff = body.scrollHeight - body.clientHeight\n      //console.log(\"contrib : \" + heightDiff + ', ' + body.scrollHeight + ', ' + body.clientHeight)\n      if (heightDiff < 15) {\n        setExpanded('expanded')\n      }\n      else {\n        setShowExpand(true)\n      }\n    }, 100)\n  }, [bodyRef])\n\n  const dynStyle = {\n    color: props.color,\n    borderColor: props.color\n  }\n\n  return <li key={props.id} className=\"contribution-list-item\">\n    <h1>{props.contrib.contribution_versions_title}</h1>\n    <div className=\"contribution-body\" >\n      <div className={\"text \" + expanded} ref={bodyRef}>{props.contrib.contribution_versions_bodyText}</div>\n      {expanded === '' && <div className='mask'></div>}\n    </div>\n    <div className=\"bottom\">\n      <div className=\"buttons\">{showExpand && <button onClick={toggleExpand}>{command}</button>}</div>\n      <div className=\"vote-count\" style={dynStyle}>\n        <div className=\"scale\"><Scale radius={8} color={props.color} score={props.contrib.contributions_votesCountOk} quantiles={props.quantiles}></Scale></div>\n        <div className=\"count\">{number_format(props.contrib.contributions_votesCountOk)} votes favorables / {number_format(props.contrib.contributions_votesCount)} exprimés</div>\n      </div>\n    </div>\n  </li>\n}\n\n// Contribution list\nconst ContributionList = (props) => {\n\n  const contributionListRef = React.useRef(null)\n\n  function getTopicScaleColor(id) {\n    return props.colorPalette[id % props.colorPalette.length]\n  }\n\n  var contributionSummary = null\n  if (props.contributions !== undefined) {\n    contributionSummary = props.contributions\n      .map((c, i) => <ContributionItem key={props.id + '_' + i} id={props.id + '_' + i} contrib={c}\n        color={getTopicScaleColor(c.topic_id)} quantiles={props.quantiles}></ContributionItem>)\n  }\n\n  var title = '', subtitle = '', dynStyle = {};\n  if (props.title) {\n    title += props.title.topic\n    if (!!props.title.keyword) {\n      title += ' > ' + props.title.keyword\n    }\n    subtitle = number_format(props.title.votesCountOk) + \" votes favorables / \" + number_format(props.title.votesCountOk) + \" exprimés\"\n\n    if (props.title.topic_id !== undefined) {\n      const color = getTopicScaleColor(props.title.topic_id)\n      dynStyle = {\n        color: color,\n        borderColor: color\n      }\n    }\n  }\n\n  React.useEffect(() => {\n    contributionListRef.current.scrollTo(0, 0)\n  }, [contributionSummary])\n\n  return <div ref={contributionListRef} className=\"contribution-list\">\n    <h1>{title}</h1>\n    <h2 style={dynStyle}>{subtitle}</h2>\n    <ul className=\"contribution-list-list\">\n      {contributionSummary}\n    </ul>\n  </div>\n}\n\nContributionList.propTypes = {\n  title: PropTypes.object,\n  color: PropTypes.string,\n  contributions: PropTypes.array\n}\n\nexport default ContributionList","import './App.css';\nimport graphData from './data/le-vrai-debat.json'\nimport Chart from './components/Chart'\nimport NetworkGraph from './components/NetworkGraph'\nimport ContributionList from './components/ContributionList'\n\nimport React from 'react';\nimport { createBrowserHistory } from 'history';\nimport axios from 'axios';\n\n\nfunction App() {\n\n  // Topic color palettes for node shape\n  // From https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/\n  // Column 3\n  const colorPalette = ['#E6B0AA', '#D7BDE2', '#A9CCE3', \n                        '#A3E4D7', '#FAD7A0', '#F5B7B1', \n                        '#D2B4DE', '#A9DFBF', '#F9E79F']\n  // Topic color palettes for texts and scale\n  // From https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/\n  // Column 5 or 6\n  const colorPaletteScale = ['#CD6155', '#9B59B6', '#2980B9', \n                            '#1ABC9C', '#F39C12', '#E74C3C',\n                            '#8E44AD',  '#27AE60', '#F1C40F']\n\n  // Contribution \"quantiles\" = repartition by importance of number of positive votes\n  const quantiles = [500, 1000, 2500, 4000]\n\n  const [loaded, setLoaded] = React.useState(false)\n  const [filterTitle, setFilterTitle] = React.useState({topic: null, keyword: null})\n  const [selectedContributions, setSelectedContributions] = React.useState([])\n  const [selectionId, setSelectionId] = React.useState(\"root_unknown\")\n\n  // Get the contributions related to the topic (& keyword) or the whole (id=\"root\")\n  function getTopicContributions(topic_id, keyword_id) {\n    if (keyword_id === undefined || keyword_id === null) {\n      const filePath = './data/topic_' + topic_id + '_main_contributions.json'\n      axios.get(filePath)\n        .then((result) => {\n          setSelectedContributions(result.data)\n        })\n        .catch((error) => {\n          console.log(error);\n        })\n    }\n    else {\n      const filePath = './data/topic_' + topic_id + '_keyword_' + keyword_id + '_main_contributions.json'\n      axios.get(filePath)\n        .then((result) => {\n          setSelectedContributions(result.data)\n        })\n        .catch((error) => {\n          console.log(error);\n        })\n    }\n  }\n\n  // Update the view when a topic (and a keyword) are selected\n  function selectTopic(topic_id, topic_title, keyword_id, keyword) {\n    console.log(\"Topic clicked: topic='\" + topic_title + \"', keyword=\" + keyword)\n    var topic;\n    if(topic_id === 'root') {\n      topic = graphData.root[0]\n    }\n    else {\n      topic = graphData.nodes[topic_id]\n    }\n\n    setFilterTitle({topic: topic_title, keyword: keyword, votesCount: topic.votesCount, votesCountOk: topic.votesCountOk, topic_id: topic_id})\n    getTopicContributions(topic_id, keyword_id)\n    setSelectionId('' + topic_id + '_' + ((keyword_id !== null)?keyword_id:'unknown'))\n  }\n\n  // Select root by default\n  React.useEffect(() => {\n    if(!loaded){\n      selectTopic('root', \"Le Vrai Débat\", null)\n      setLoaded(true)\n    }\n  }, [loaded])\n\n  // Viewport sizing dimensions but not to set hard dimensions on the graph\n  const width = 700, height = 700;\n\n  return (\n    <div className=\"App\">\n      <div className=\"app-wrap\">\n        <div className=\"chart-wrap\">\n          <Chart chartId='first' width={width} height={height} zoomtool={false}>\n            <NetworkGraph width={width} height={height} data={graphData}\n              onClick={selectTopic} colors={colorPalette}></NetworkGraph>\n          </Chart>\n        </div>\n        <div className=\"contributions-wrap\">\n          <ContributionList title={filterTitle} contributions={selectedContributions} id={selectionId} \n            colorPalette={colorPaletteScale} quantiles={quantiles}></ContributionList>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Locate the final installation within a subdirectory\nexport const history = createBrowserHistory({\n  basename: process.env.PUBLIC_URL\n}); \n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}